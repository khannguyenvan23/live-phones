!function(t){var e={};function a(r){if(e[r])return e[r].exports;var c=e[r]={i:r,l:!1,exports:{}};return t[r].call(c.exports,c,c.exports,a),c.l=!0,c.exports}a.m=t,a.c=e,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var c in t)a.d(r,c,function(e){return t[e]}.bind(null,c));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){"use strict";a.r(e);class r{async getData(){try{const t=await fetch("https://5f2a9bd76ae5cc0016422c69.mockapi.io/product");this.data=await t.json()}catch(t){console.log(t)}return this.persistData(),this.data}persistData(){localStorage.setItem("homeData",JSON.stringify(this.data))}readStorage(){const t=JSON.parse(localStorage.getItem("homeData"));t&&(this.data=t)}}class c{constructor(t){this.id=t}async getData(){try{const t=await fetch("https://5f2a9bd76ae5cc0016422c69.mockapi.io/product/"+this.id),e=await t.json();this.name=e.name,this.price=e.price,this.image=e.image,this.totalPrice=this.price}catch(t){console.log(t)}}updateAmount(t){const e="down"===t?this.amount-1:this.amount+1;this.totalPrice=e*this.price,this.amount=e}getTotalPrice(){return this.totalPrice}setAmount(t){this.amount=t,this.totalPrice=this.amount*this.price}getAmount(){return this.amount}}const o={cards:document.querySelector(".cards-container"),cardAmount:document.querySelector(".number"),filterTypePhone:document.getElementById("filterTypePhone"),sortFisrtWord:document.getElementById("sortFisrtWord"),resetFilter:document.getElementById("resetFilter"),navShopAmount:document.querySelectorAll(".nav__shop-amount"),shopping:document.querySelector(".lst-product__container"),productpay:document.querySelector(".lst-product__pay"),cartspay:document.querySelector(".carts__pay")},s="lds-ring",n="bccsp",i=()=>{o.productpay.style.display="block"},d=()=>{o.productpay.style.display="none"},u=t=>{const e=`\n        <div class="${s}"><div></div><div></div><div></div><div></div></div>\n    `;t.insertAdjacentHTML("beforebegin",e)},l=()=>{const t=document.querySelector("."+s);t&&t.parentElement.removeChild(t)},p=(t,e)=>{const a=document.querySelector(`[data-id="${t}"]`);a.children[4].style.display="block",a.children[5].style.display="none",e&&(document.querySelector(`[data-amount="${t}"]`).value=e)},m=t=>{const e=document.querySelector(`[data-id="${t}"]`);e.children[4].style.display="none",e.children[5].style.display="flex"},h=t=>{let e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),e.join(".")},g=()=>{const t=`\n        <p style="text-align: center" class="${n}">B·∫°n ch∆∞a c√≥ s·∫£n ph·∫©m n√†o</p>\n    `;o.shopping.insertAdjacentHTML("beforeend",t)},y=()=>{const t=document.querySelector("."+n);t&&t.parentElement.removeChild(t)},P=()=>{o.cards.innerHTML=""},f=t=>{t.forEach(t=>{v(t)})},v=t=>{const e=o.cards;if(!t)return;const{id:a,name:r,image:c,price:s}=t,n=`\n           <figure class="card" data-id="${a}">\n                <div class="card__hero">\n                    <img src="${c}" alt="" class="card__img">\n                </div>\n                <h2 class="card__name">${r}</h2>\n                <p class="card__price">\n                     <span class="emoji-left">${h(s)}</span> ƒê</p>\n                </p>\n                <div class="updown">\n                    <div class="down"><span></span></div>\n                    <input class="number" data-amount="${a}" value="1" maxlength="50" pattern="[0-9]*" type="number">\n                    <div class="up"><span></span><span></span></div>\n                </div>\n                <div class="card__footer">\n                    <button class="card__link add__cart" data-id="${a}">\n                        <span class="emoji-left">üëâ</span> Th√™m v√†o gi·ªè h√†ng\n                    </button>\n                </div>\n           </figure>\n    `;e.insertAdjacentHTML("beforeend",n)};class _{constructor(){this.carts=[],this.totalPrice=0}addProduct(t){this.carts.push(t),this.persistData()}resetCarts(){this.carts=[],this.totalPrice=0,this.persistData()}deleteProduct(t){const e=this.carts.findIndex(e=>e.id===t);this.carts.splice(e,1),this.persistData()}isProduct(t){return-1!==this.carts.findIndex(e=>e.id===t)}getProduct(t){return this.carts.find(e=>e.id===t)}replaceProduct(t,e){const a=this.carts.findIndex(e=>e.id===t);this.carts.splice(a,1,e),this.persistData()}getNumProduct(){return this.carts.length}caculatePrice(){this.carts.length>1?this.totalPrice=this.carts.reduce((t,e)=>t+=e.getTotalPrice(),0):this.carts.length>0?this.totalPrice=this.carts[0].getTotalPrice():this.totalPrice=0,this.persistData()}persistData(){localStorage.setItem("CarstData",JSON.stringify(this.carts)),localStorage.setItem("TotalPrice",JSON.stringify(this.totalPrice))}readStorage(){const t=JSON.parse(localStorage.getItem("CarstData"));t.map(t=>t.__proto__=new c);const e=JSON.parse(localStorage.getItem("TotalPrice"));t&&(this.carts=t),e&&(this.totalPrice=e)}}const S=(t,e)=>{document.querySelector(`[data-amount="${e}"]`).value=t},A=(t,e=0)=>{const a=o.navShopAmount[0],r=o.navShopAmount[1],c=h(t);e>0?a.textContent=e:-1===e&&(e=0,a.textContent=e),r.textContent=c,document.querySelector(".tong-thanh-toan strong").textContent=c+" ƒë"},b=(t,e)=>{document.querySelector(`[data-nokia="${e}"]`).value=t},$=(t,e)=>{const a=h(t);document.querySelector(`[data-totalprice="${e}"]`).textContent=a+"ƒë"},q=t=>{let{id:e,name:a,image:r,totalPrice:c,amount:s}=t;s||(s=1);const n=`\n      <div data-code="${e}" class="carts___item">\n         <div class="carts___item-img">\n            <img src="${r}" width="60" height="60"> \n         </div>\n      \n         <div class="carts___item-info">\n            <p>${a}</p>\n            <div class="control-item">\n               <div class="quantitynum">\n                     <button class="des">-</button> <input type="number" data-nokia="${e}" value="${s}"> <button class="ins">+</button>\n               </div> \n               <button class="delete">X√≥a</button> \n            </div>\n         </div>\n         <div class="carts___item-colmoney" data-totalprice="${e}"><strong>${h(c)} ƒë</strong>\n         </div>\n      </div>\n   `;o.shopping.insertAdjacentHTML("beforeend",n)};let w,j={};const x=async()=>{const t=new r;P(),u(o.cards);try{t.readStorage(),j.data=await t.getData(),w=[...j.data],f(j.data),document.querySelector(".filter").style.display="flex",l()}catch(t){l(),alert("L·ªói"+t)}},E=(t,e)=>{if(P(),u(o.cards),"normal"===t&&"reset"===e)return f(j.data),void l();"sort"===e&&(w=((t,e)=>{let a=[...e];return"A-Z"===t?a.sort((t,e)=>t.name[0].toUpperCase()>e.name[0].toUpperCase()?1:-999):"Z-A"===t?a.sort((t,e)=>t.name[0].toUpperCase()>e.name[0].toUpperCase()?-999:1):void 0})(t,w)),"filter"===e&&(w=((t,e)=>{let a=[...e];return"apple"===t||"xiaomi"===t||"samsung"===t||"oppo"===t||"vsmart"===t?a.filter(e=>e.type===t):void 0})(t,w)),f(w),l()};window.addEventListener("load",async()=>{await x(),j.carts||(j.carts=new _),j.carts.readStorage(),0===j.carts.getNumProduct()?g():(i(),y()),A(j.carts.totalPrice,j.carts.getNumProduct()),j.carts.carts.forEach(t=>{p(t.id,t.amount),q(t)})});const I=o.sortFisrtWord,C=o.filterTypePhone,L=o.resetFilter;I.addEventListener("change",(function(){const t=this.value;t&&E(t,"sort")})),C.addEventListener("change",(function(){w=[...j.data];const t=this.value;t&&E(t,"filter")})),L.addEventListener("click",(function(){const t=this.value;t&&(E(t,"reset"),I[0].selected=!0,C[0].selected=!0)})),o.cards.addEventListener("change",async t=>{const e=t.target.closest(".card").dataset.id;if(e){let t=parseInt(document.querySelector(`[data-amount="${e}"]`).value);j.product=j.carts.getProduct(e),j.product.setAmount(t),j.carts.replaceProduct(e,j.product),j.carts.caculatePrice(),A(j.carts.totalPrice),S(j.product.getAmount(),e),b(j.product.getAmount(),e),$(j.product.totalPrice,e)}}),o.shopping.addEventListener("change",async t=>{const e=t.target.closest(".carts___item").dataset.code;if(e){let t=parseInt(document.querySelector(`[data-nokia="${e}"]`).value);j.product=j.carts.getProduct(e),j.product.setAmount(t),j.carts.replaceProduct(e,j.product),j.carts.caculatePrice(),A(j.carts.totalPrice),S(j.product.getAmount(),e),b(j.product.getAmount(),e),$(j.product.totalPrice,e)}}),o.cards.addEventListener("click",async t=>{const e=t.target.closest(".card").dataset.id;if(e)if(t.target.matches(".down, .down *")){if(j.carts.isProduct(e)&&j.product.getAmount()>0){const t=parseInt(document.querySelector(`[data-amount="${e}"]`).value);j.product=j.carts.getProduct(e),j.product.setAmount(t),j.product.updateAmount("down"),j.carts.caculatePrice(),j.carts.replaceProduct(e,j.product),A(j.carts.totalPrice),S(j.product.getAmount(),e),b(j.product.getAmount(),e),$(j.product.totalPrice,e)}}else if(t.target.matches(".up, .up *")){if(j.carts.isProduct(e)){const t=parseInt(document.querySelector(`[data-amount="${e}"]`).value);j.product=j.carts.getProduct(e),j.product.setAmount(t),j.product.updateAmount("up"),j.carts.caculatePrice(),j.carts.replaceProduct(e,j.product),A(j.carts.totalPrice),S(j.product.getAmount(),e),b(j.product.getAmount(),e),$(j.product.totalPrice,e)}}else t.target.matches(".add__cart, .add__cart *")&&(await(async t=>{if(!t)return;const e=new c(t);try{await e.getData(),j.product=e}catch(t){l(),alert("L·ªói asfsajfj"+t)}})(e),i(),p(e),(()=>{j.carts||(j.carts=new _);const t=j.product.id;j.carts.isProduct(t)||j.carts.isProduct(t)||(j.carts.addProduct(j.product),j.carts.caculatePrice(),A(j.carts.totalPrice,j.carts.getNumProduct()),y(),q(j.product))})())}),o.shopping.addEventListener("click",async t=>{const e=t.target.closest(".carts___item").dataset.code;if(e)if(t.target.matches(".des, .des *")){if(j.carts.isProduct(e)&&j.product.getAmount()>0){const t=parseInt(document.querySelector(`[data-amount="${e}"]`).value);j.product=j.carts.getProduct(e),j.product.setAmount(t),j.product.updateAmount("down"),j.carts.caculatePrice(),j.carts.replaceProduct(e,j.product),A(j.carts.totalPrice),S(j.product.getAmount(),e),b(j.product.getAmount(),e),$(j.product.totalPrice,e)}}else if(t.target.matches(".ins, .ins *")){if(j.carts.isProduct(e)){const t=parseInt(document.querySelector(`[data-amount="${e}"]`).value);j.product=j.carts.getProduct(e),j.product.setAmount(t),j.product.updateAmount("up"),j.carts.caculatePrice(),j.carts.replaceProduct(e,j.product),A(j.carts.totalPrice),S(j.product.getAmount(),e),b(j.product.getAmount(),e),$(j.product.totalPrice,e)}}else t.target.matches(".delete, .delete *")&&j.carts.isProduct(e)&&(j.carts.deleteProduct(e),(t=>{const e=document.querySelector(`[data-code="${t}"]`);e&&e.parentElement.removeChild(e)})(e),m(e),document.querySelector(`[data-amount="${e}"]`).value=1,j.carts.getNumProduct()>0?(j.carts.caculatePrice(),A(j.carts.totalPrice,j.carts.getNumProduct())):(j.carts.caculatePrice(),A(j.carts.totalPrice,-1),g(),d()))}),o.cartspay.addEventListener("click",()=>{console.log("delete"),j.carts.carts.length>0&&(j.carts.carts.forEach(t=>{document.querySelector(`[data-amount="${t.id}"]`).value=1,m(t.id)}),j.carts.resetCarts(),console.log(j.carts.totalPrice),o.shopping.innerHTML="",A(j.carts.totalPrice,-1),console.log(j.carts.carts),d(),g(),alert("ƒê·∫∑t h√†ng th√†nh c√¥ng!"))}),console.log("Copyright by Nguyen Van Khan")}]);